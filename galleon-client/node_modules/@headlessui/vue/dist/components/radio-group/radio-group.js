import{Fragment as H,computed as d,defineComponent as S,h as G,inject as N,onMounted as V,onUnmounted as K,provide as M,ref as h,toRaw as v}from"vue";import{dom as $}from'../../utils/dom.js';import{Keys as g}from'../../keyboard.js';import{focusIn as A,Focus as k,FocusResult as F,sortByDomNode as U}from'../../utils/focus-management.js';import{useId as C}from'../../hooks/use-id.js';import{compact as _,omit as D,render as L}from'../../utils/render.js';import{Label as W,useLabels as x}from'../label/label.js';import{Description as J,useDescriptions as I}from'../description/description.js';import{useTreeWalker as q}from'../../hooks/use-tree-walker.js';import{Hidden as Q,Features as X}from'../../internal/hidden.js';import{attemptSubmit as Y,objectToFormEntries as Z}from'../../utils/form.js';import{getOwnerDocument as T}from'../../utils/owner.js';import{useControllable as z}from'../../hooks/use-controllable.js';function ee(t,c){return t===c}let P=Symbol("RadioGroupContext");function B(t){let c=N(P,null);if(c===null){let i=new Error(`<${t} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,B),i}return c}let ye=S({name:"RadioGroup",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ee},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},name:{type:String,optional:!0}},inheritAttrs:!1,setup(t,{emit:c,attrs:i,slots:w,expose:p}){let u=h(null),o=h([]),E=x({name:"RadioGroupLabel"}),b=I({name:"RadioGroupDescription"});p({el:u,$el:u});let[R,y]=z(d(()=>t.modelValue),e=>c("update:modelValue",e),d(()=>t.defaultValue)),s={options:o,value:R,disabled:d(()=>t.disabled),firstOption:d(()=>o.value.find(e=>!e.propsRef.disabled)),containsCheckedOption:d(()=>o.value.some(e=>s.compare(v(e.propsRef.value),v(t.modelValue)))),compare(e,a){if(typeof t.by=="string"){let n=t.by;return(e==null?void 0:e[n])===(a==null?void 0:a[n])}return t.by(e,a)},change(e){var n;if(t.disabled||s.compare(v(R.value),v(e)))return!1;let a=(n=o.value.find(l=>s.compare(v(l.propsRef.value),v(e))))==null?void 0:n.propsRef;return a!=null&&a.disabled?!1:(y(e),!0)},registerOption(e){o.value.push(e),o.value=U(o.value,a=>a.element)},unregisterOption(e){let a=o.value.findIndex(n=>n.id===e);a!==-1&&o.value.splice(a,1)}};M(P,s),q({container:d(()=>$(u)),accept(e){return e.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(e){e.setAttribute("role","none")}});function m(e){if(!u.value||!u.value.contains(e.target))return;let a=o.value.filter(n=>n.propsRef.disabled===!1).map(n=>n.element);switch(e.key){case g.Enter:Y(e.currentTarget);break;case g.ArrowLeft:case g.ArrowUp:if(e.preventDefault(),e.stopPropagation(),A(a,k.Previous|k.WrapAround)===F.Success){let l=o.value.find(r=>{var f;return r.element===((f=T(u))==null?void 0:f.activeElement)});l&&s.change(l.propsRef.value)}break;case g.ArrowRight:case g.ArrowDown:if(e.preventDefault(),e.stopPropagation(),A(a,k.Next|k.WrapAround)===F.Success){let l=o.value.find(r=>{var f;return r.element===((f=T(r.element))==null?void 0:f.activeElement)});l&&s.change(l.propsRef.value)}break;case g.Space:{e.preventDefault(),e.stopPropagation();let n=o.value.find(l=>{var r;return l.element===((r=T(l.element))==null?void 0:r.activeElement)});n&&s.change(n.propsRef.value)}break}}let O=`headlessui-radiogroup-${C()}`;return()=>{let{disabled:e,name:a,...n}=t,l={ref:u,id:O,role:"radiogroup","aria-labelledby":E.value,"aria-describedby":b.value,onKeydown:m};return G(H,[...a!=null&&R.value!=null?Z({[a]:R.value}).map(([r,f])=>G(Q,_({features:X.Hidden,key:r,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:r,value:f}))):[],L({ourProps:l,theirProps:{...i,...D(n,["modelValue","defaultValue"])},slot:{},attrs:i,slots:w,name:"RadioGroup"})])}}});var te=(i=>(i[i.Empty=1]="Empty",i[i.Active=2]="Active",i))(te||{});let ge=S({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(t,{attrs:c,slots:i,expose:w}){let p=B("RadioGroupOption"),u=`headlessui-radiogroup-option-${C()}`,o=x({name:"RadioGroupLabel"}),E=I({name:"RadioGroupDescription"}),b=h(null),R=d(()=>({value:t.value,disabled:t.disabled})),y=h(1);w({el:b,$el:b}),V(()=>p.registerOption({id:u,element:b,propsRef:R})),K(()=>p.unregisterOption(u));let s=d(()=>{var r;return((r=p.firstOption.value)==null?void 0:r.id)===u}),m=d(()=>p.disabled.value||t.disabled),O=d(()=>p.compare(v(p.value.value),v(t.value))),e=d(()=>m.value?-1:O.value||!p.containsCheckedOption.value&&s.value?0:-1);function a(){var r;!p.change(t.value)||(y.value|=2,(r=b.value)==null||r.focus())}function n(){y.value|=2}function l(){y.value&=-3}return()=>{let r=D(t,["value","disabled"]),f={checked:O.value,disabled:m.value,active:Boolean(y.value&2)},j={id:u,ref:b,role:"radio","aria-checked":O.value?"true":"false","aria-labelledby":o.value,"aria-describedby":E.value,"aria-disabled":m.value?!0:void 0,tabIndex:e.value,onClick:m.value?void 0:a,onFocus:m.value?void 0:n,onBlur:m.value?void 0:l};return L({ourProps:j,theirProps:r,slot:f,attrs:c,slots:i,name:"RadioGroupOption"})}}}),Oe=W,he=J;export{ye as RadioGroup,he as RadioGroupDescription,Oe as RadioGroupLabel,ge as RadioGroupOption};
